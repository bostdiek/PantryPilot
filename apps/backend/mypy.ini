[mypy]
# Ensure mypy can resolve top-level packages (core, models, etc.) located under ./src
mypy_path = ./src

# Avoid duplicate module discovery between "." (which exposes "src.*") and "./src"
explicit_package_bases = True

# Enable namespace packages in case the project uses them.
namespace_packages = True

# Follow imports normally so mypy checks project modules as expected.
follow_imports = normal

# Limit files to the src folder to avoid checking other workspace files.
files = src

# Exclude test and script paths even when a broad CLI target (".") is passed.
# Use a more flexible regex so the pattern matches whether mypy is run from
# the repo root or from `apps/backend` (CI/Makefile runs `cd apps/backend`).
# Matches paths like 'tests/', './tests/', 'apps/backend/tests/', etc.
exclude = (^|/)(tests|scripts)/

# Target Python version for accurate builtin types and stubs
python_version = 3.12

# NOTE:
# The repository also contains `[tool.mypy]` settings in `pyproject.toml`.
# By default mypy searches for config files in the current working directory
# and will pick the first one it finds (e.g. `mypy.ini` in `apps/backend`).
# The Makefile runs mypy from `apps/backend` (see `make type-check-backend`),
# so this file is the effective configuration during CI/local `make` runs.
# To keep behavior consistent, we enable the same "strict" flags here that
# are declared in `pyproject.toml`.

# Strictness flags (mirrors `[tool.mypy]` in pyproject.toml)
check_untyped_defs = True
disallow_any_generics = True
disallow_incomplete_defs = True
disallow_untyped_defs = True
no_implicit_optional = True
no_implicit_reexport = True
strict_equality = True
warn_redundant_casts = True
warn_return_any = True
warn_unreachable = True
warn_unused_configs = True
warn_unused_ignores = True

# Per-module overrides for third-party packages without stubs
[mypy-azure.monitor.*]
ignore_missing_imports = True

[mypy-opentelemetry.*]
ignore_missing_imports = True
