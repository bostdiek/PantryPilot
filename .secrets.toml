# detect-secrets configuration for PantryPilot
# https://detect-secrets.readthedocs.io/en/latest/usage.html#configuration

[tool.detect-secrets]
baseline = ".secrets.baseline"

# Exclude common directories and files that don't need secret scanning
exclude_files = [
    "^apps/frontend/node_modules/.*",
    "^apps/backend/.venv/.*",
    "^.git/.*",
    "^apps/frontend/dist/.*",
    "^apps/frontend/coverage/.*",
    "^apps/backend/htmlcov/.*",
    "^backups/.*",
    "^.tmp/.*",
    ".*\\.lock$",
    ".*\\.log$",
    ".*\\.coverage$",
    ".*\\.pyc$",
    ".*\\.ico$",
    ".*\\.png$",
    ".*\\.jpg$",
    ".*\\.jpeg$",
    ".*\\.gif$",
    ".*\\.svg$",
    ".*\\.woff$",
    ".*\\.woff2$",
    ".*\\.ttf$"
]

# Custom filters for false positives
filters_used = [
    { path = "detect_secrets.filters.allowlist.is_line_allowlisted" },
    { path = "detect_secrets.filters.common.is_baseline_file" },
    { path = "detect_secrets.filters.common.is_ignored_due_to_verification_policies", min_level = 2 },
    { path = "detect_secrets.filters.heuristic.is_likely_id_string" },
    { path = "detect_secrets.filters.heuristic.is_lock_file" },
    { path = "detect_secrets.filters.heuristic.is_not_alphanumeric_string" },
    { path = "detect_secrets.filters.heuristic.is_potential_uuid" },
    { path = "detect_secrets.filters.heuristic.is_prefixed_with_dollar_sign" },
    { path = "detect_secrets.filters.heuristic.is_sequential_string" },
    { path = "detect_secrets.filters.heuristic.is_swagger_file" },
    { path = "detect_secrets.filters.heuristic.is_templated_secret" }
]

# Plugins configuration
plugins_used = [
    { name = "ArtifactoryDetector" },
    { name = "AWSKeyDetector" },
    { name = "AzureStorageKeyDetector" },
    { name = "Base64HighEntropyString", limit = 4.5 },
    { name = "BasicAuthDetector" },
    { name = "CloudantDetector" },
    { name = "DiscordBotTokenDetector" },
    { name = "GitHubTokenDetector" },
    { name = "GitLabTokenDetector" },
    { name = "HexHighEntropyString", limit = 3.0 },
    { name = "IbmCloudIamDetector" },
    { name = "IbmCosHmacDetector" },
    { name = "IPPublicDetector" },
    { name = "JwtTokenDetector" },
    { name = "KeywordDetector" },
    { name = "MailchimpDetector" },
    { name = "NpmDetector" },
    { name = "OpenAIDetector" },
    { name = "PrivateKeyDetector" },
    { name = "PypiDetector" },
    { name = "SendGridDetector" },
    { name = "SlackDetector" },
    { name = "SoftlayerDetector" },
    { name = "SquareOAuthDetector" },
    { name = "StripeDetector" },
    { name = "TelegramBotTokenDetector" },
    { name = "TwilioKeyDetector" }
]
